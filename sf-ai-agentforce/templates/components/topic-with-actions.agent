# Topic with Actions Template
# A topic that integrates with external systems via Flow or Apex actions
# This is a PARTIAL template - use within a complete agent file
#
# ⚠️ DEPLOYMENT METHOD MATTERS:
#    - AiAuthoringBundle: `with`/`set` clauses in reasoning.actions NOT supported
#    - GenAiPlannerBundle: Full syntax including `with`/`set` supported
#
# For AiAuthoringBundle: Define actions in topics, let LLM auto-invoke based on description
#
# Usage: Replace {{placeholders}} with your values
# Note: Actions defined inside topic are local to that topic

topic {{topic_name}}:
	label: "{{TopicLabel}}"
	description: "{{TopicDescription}}"

	# Define actions available to this topic
	actions:
		{{action_name}}:
			description: "{{ActionDescription}}"
			inputs:
				{{input_name}}: {{input_type}}
					description: "{{InputDescription}}"
			outputs:
				{{output_name}}: {{output_type}}
					description: "{{OutputDescription}}"
			target: "{{ActionTarget}}"  # flow://FlowName or apex://ClassName.methodName

	reasoning:
		instructions: ->
			| {{TopicInstructions}}
			| Use the available actions to help the user.
			| Capture and communicate results clearly.
		actions:
			# ═══════════════════════════════════════════════════════════════════════
			# ⚠️ GenAiPlannerBundle ONLY - `with`/`set` syntax below does NOT work
			#    in AiAuthoringBundle (causes "Internal Error" at publish time)
			# ═══════════════════════════════════════════════════════════════════════
			invoke_action: @actions.{{action_name}}
				with {{input_name}}=...
				set @variables.{{result_variable}} = @outputs.{{output_name}}

			# ✅ For AiAuthoringBundle: Just use transitions (LLM auto-invokes actions)
			back_to_menu: @utils.transition to @topic.topic_selector
