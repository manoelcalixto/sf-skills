# Val_After_Reasoning - Tests after_reasoning lifecycle hook
# Purpose: Verify after_reasoning block executes deterministic post-processing
#
# Tests:
#   ✓ after_reasoning block within topic
#   ✓ Deterministic set operations in after_reasoning
#   ✓ Conditional logic for post-LLM actions
#   ✓ Transition commands in after_reasoning
#
# SKILL.md Section: Lifecycle Hooks - after_reasoning
# Source: trailheadapps/agent-script-recipes (03_reasoningMechanics/AfterReasoning.agent)

system:
   messages:
      welcome: "After reasoning validation ready."
      error: "After reasoning validation error."
   instructions: "This agent tests the after_reasoning lifecycle hook."

config:
   agent_name: "Val_After_Reasoning"
   agent_label: "Validation: After Reasoning Hook"
   description: "Tests after_reasoning deterministic post-processing"
   default_agent_user: "home_furnishing_agent@00dvz000004evdp1379858245.ext"

variables:
   interaction_logged: mutable boolean = False
   needs_audit: mutable boolean = True
   post_processed: mutable boolean = False

topic main:
   description: "Test after_reasoning lifecycle hook"
   reasoning:
      instructions: |
         Process the user request. After this, deterministic post-processing will occur.
   after_reasoning:
      # Deterministic post-processing after LLM finishes
      # Content goes DIRECTLY under after_reasoning (no instructions: wrapper)
      set @variables.post_processed = True
      if @variables.needs_audit == True:
         set @variables.interaction_logged = True

topic verify:
   description: "Verify after_reasoning executed"
   reasoning:
      instructions: ->
         if @variables.post_processed == True and @variables.interaction_logged == True:
            | After reasoning validation PASSED.
         else:
            | After reasoning validation FAILED.

start_agent entry:
   description: "Entry point for after_reasoning validation"
   reasoning:
      instructions: |
         Begin after_reasoning lifecycle hook validation.
      actions:
         begin: @utils.transition to @topic.main
            description: "Start after_reasoning tests"
